{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr';\nimport { NextResponse, type NextRequest } from 'next/server';\n\nexport async function middleware(request: NextRequest) {\n  const response = NextResponse.next({\n    request: {\n      headers: request.headers,\n    },\n  });\n\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n  if (!supabaseUrl || !supabaseAnonKey) {\n    console.error('Missing Supabase environment variables');\n    return response;\n  }\n\n  const supabase = createServerClient(supabaseUrl, supabaseAnonKey, {\n    cookies: {\n      getAll() {\n        return request.cookies.getAll();\n      },\n      setAll(cookiesToSet) {\n        cookiesToSet.forEach(({ name, value, options }) => {\n          request.cookies.set(name, value);\n          response.cookies.set(name, value, options);\n        });\n      },\n    },\n  });\n\n  // Check if user is authenticated by getting the session\n  let session = null;\n  try {\n    const {\n      data: { session: userSession },\n    } = await supabase.auth.getSession();\n    session = userSession;\n  } catch (error) {\n    // Ignore auth session missing errors - this is expected for unauthenticated users\n    if (\n      error instanceof Error &&\n      error.message.includes('Auth session missing')\n    ) {\n      // This is expected behavior, no need to log it\n    } else {\n      console.error('Unexpected auth error in middleware:', error);\n    }\n  }\n\n  // Define protected routes that require authentication\n  const protectedRoutes = [\n    '/dashboard',\n    '/profile',\n    '/calendar',\n    '/exercises',\n    '/routines',\n    '/workout-tracker',\n    '/equipment',\n    '/gyms',\n    '/health',\n    '/performance',\n    '/suggestions',\n    '/trainer-and-clubs',\n    '/account-settings',\n    '/app-settings',\n    '/help-support',\n  ];\n\n  // Define auth routes that should redirect authenticated users\n  const authRoutes = ['/login', '/signup'];\n\n  const isProtectedRoute = protectedRoutes.some(route =>\n    request.nextUrl.pathname.startsWith(route)\n  );\n  const isAuthRoute = authRoutes.some(route =>\n    request.nextUrl.pathname.startsWith(route)\n  );\n\n  // Redirect unauthenticated users to login for protected routes\n  if (isProtectedRoute && !session) {\n    const loginUrl = new URL('/login', request.url);\n    return NextResponse.redirect(loginUrl);\n  }\n\n  // Redirect authenticated users away from auth routes to dashboard\n  if (isAuthRoute && session) {\n    const dashboardUrl = new URL('/dashboard', request.url);\n    return NextResponse.redirect(dashboardUrl);\n  }\n\n  return response;\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * Feel free to modify this pattern to include more paths.\n     */\n    '/((?!_next/static|_next/image|favicon.ico).*)',\n  ],\n};\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;;;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,WAAW,qYAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QACjC,SAAS;YACP,SAAS,QAAQ,OAAO;QAC1B;IACF;IAEA,MAAM;IACN,MAAM;IAEN;;IAKA,MAAM,WAAW,CAAA,GAAA,8RAAA,CAAA,qBAAkB,AAAD,EAAE,aAAa,iBAAiB;QAChE,SAAS;YACP;gBACE,OAAO,QAAQ,OAAO,CAAC,MAAM;YAC/B;YACA,QAAO,YAAY;gBACjB,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE;oBAC5C,QAAQ,OAAO,CAAC,GAAG,CAAC,MAAM;oBAC1B,SAAS,OAAO,CAAC,GAAG,CAAC,MAAM,OAAO;gBACpC;YACF;QACF;IACF;IAEA,wDAAwD;IACxD,IAAI,UAAU;IACd,IAAI;QACF,MAAM,EACJ,MAAM,EAAE,SAAS,WAAW,EAAE,EAC/B,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;QAClC,UAAU;IACZ,EAAE,OAAO,OAAO;QACd,kFAAkF;QAClF,IACE,iBAAiB,SACjB,MAAM,OAAO,CAAC,QAAQ,CAAC,yBACvB;QACA,+CAA+C;QACjD,OAAO;YACL,QAAQ,KAAK,CAAC,wCAAwC;QACxD;IACF;IAEA,sDAAsD;IACtD,MAAM,kBAAkB;QACtB;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,8DAA8D;IAC9D,MAAM,aAAa;QAAC;QAAU;KAAU;IAExC,MAAM,mBAAmB,gBAAgB,IAAI,CAAC,CAAA,QAC5C,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IAEtC,MAAM,cAAc,WAAW,IAAI,CAAC,CAAA,QAClC,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IAGtC,+DAA+D;IAC/D,IAAI,oBAAoB,CAAC,SAAS;QAChC,MAAM,WAAW,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9C,OAAO,qYAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,kEAAkE;IAClE,IAAI,eAAe,SAAS;QAC1B,MAAM,eAAe,IAAI,IAAI,cAAc,QAAQ,GAAG;QACtD,OAAO,qYAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;KAMC,GACD;KACD;AACH"}}]
}