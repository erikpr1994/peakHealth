(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{1976:(e,r,t)=>{"use strict";t.d(r,{SWRProvider:()=>s});var u=t(20906),a=t(49005);let n={fetcher:async e=>{let r=await fetch(e);if(!r.ok){let e=Error("An error occurred while fetching the data.");throw e.info=await r.json(),e.status=r.status,e}return r.json()},revalidateOnFocus:!1,revalidateOnReconnect:!0,dedupingInterval:2e3,errorRetryCount:3,errorRetryInterval:5e3},s=e=>{let{children:r}=e;return(0,u.jsx)(a.BE,{value:n,children:r})}},9305:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,45120,23)),Promise.resolve().then(t.bind(t,1976)),Promise.resolve().then(t.bind(t,96196))},12488:(e,r,t)=>{"use strict";var u=t(88152);t.o(u,"useParams")&&t.d(r,{useParams:function(){return u.useParams}}),t.o(u,"usePathname")&&t.d(r,{usePathname:function(){return u.usePathname}}),t.o(u,"useRouter")&&t.d(r,{useRouter:function(){return u.useRouter}})},45120:()=>{},96196:(e,r,t)=>{"use strict";t.d(r,{AuthProvider:()=>d,A:()=>h});var u=t(20906),a=t(12488),n=t(33826),s=t(49005),o=t(91670);let i=(0,n.createContext)(void 0),l=async e=>{let r=await fetch(e);if(!r.ok){if(401===r.status)return null;let e=Error("An error occurred while fetching the user.");throw e.info=await r.json(),e.status=r.status,e}return(await r.json()).user||null},d=e=>{let{children:r}=e,t=(0,o.createBrowserClient)("http://127.0.0.1:54321","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0"),d=(0,a.useRouter)(),[h,c]=(0,n.useState)(!1),{data:f,mutate:v}=(0,s.Ay)("/api/auth/user",l,{revalidateOnFocus:!0,shouldRetryOnError:!1,suspense:!0,fallbackData:null}),w=(0,n.useCallback)(async(e,r)=>{"SIGNED_IN"===e||"USER_UPDATED"===e?await v():"SIGNED_OUT"===e&&await v(null,!1)},[v]);(0,n.useEffect)(()=>{let{data:{subscription:e}}=t.auth.onAuthStateChange((e,r)=>{w(e,r)});return()=>{e.unsubscribe()}},[t,w]);let p=async(e,r)=>{if(e&&r){c(!0);try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})}),u=await t.json();if(!t.ok)throw Error(u.error||"Login failed");await v(u.user,!1),d.push("/dashboard")}finally{c(!1)}}},y=async(e,r,t)=>{if(e&&r&&t){c(!0);try{let u=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r,name:t})}),a=await u.json();if(!u.ok)throw Error(a.error||"Sign up failed");await v(a.user,!1),d.push("/dashboard")}finally{c(!1)}}},m=async()=>{c(!0);try{let e=await fetch("/api/auth/logout",{method:"POST"});if(!e.ok){let r=await e.json();throw Error(r.error||"Logout failed")}await v(null,!1),d.push("/")}finally{c(!1)}};return(0,u.jsx)(i.Provider,{value:{isAuthenticated:!!f,isAuthOperationLoading:h,login:p,logout:m,signUp:y,user:f||null,userId:(null==f?void 0:f.id)||null,userRoles:(null==f?void 0:f.userRoles)||[],userGroups:(null==f?void 0:f.userGroups)||[],hasRole:e=>{var r;return(null==f||null==(r=f.userRoles)?void 0:r.includes(e))||!1},hasGroup:e=>{var r;return(null==f||null==(r=f.userGroups)?void 0:r.includes(e))||!1},hasAnyRole:e=>(null==e?void 0:e.some(e=>{var r;return null==f||null==(r=f.userRoles)?void 0:r.includes(e)}))||!1,hasAnyGroup:e=>(null==e?void 0:e.some(e=>{var r;return null==f||null==(r=f.userGroups)?void 0:r.includes(e)}))||!1},children:r})},h=()=>{let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[5981,9005,1670,7524,8202,7358],()=>e(e.s=9305)),_N_E=e.O()}]);